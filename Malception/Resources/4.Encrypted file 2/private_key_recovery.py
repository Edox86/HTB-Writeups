#!/usr/bin/env python3
# xor_unmask_privkey.py

HEX_BLOB = """
E0 14 20 F1 15 5C 6F E5 BD 2A 06 D5 60 05 5B DC B8 33 1F C5 2D 07 23 F9 BD 77 58 FE 67 71 70 F6 AF 12 3B 87 2F 6C 75 D6 BA 2B 37 E4 08 0F 64 E1 85 14 12 DF 07 0A 73 E9 8D 3F 35 E0 6F 54 77 C9 8E 76 16 DC 1C 7D 7F E2 98 00 29 86 33 6E 5F 8A 9A 14 01 E3 2C 68 65 D4 EE 31 09 E4 34 12 52 F8 AE 70 11 DA 2A 0E 7F CB B5 01 43 C6 06 68 40 C4 BD 08 29 D6 1B 73 4E E7 91 0B 19 F3 69 6A 47 E5 97 0A 25 F7 38 49 74 DE EC 6D 41 D6 08 6D 72 EA 92 76 3C C2 14 70 52 C9 B0 28 1F E1 0E 4E 2E FF 9E 35 0B E5 1C 01 54 C0 EF 0F 58 87 3C 16 7E 8A BA 08 1D F8 3F 73 6E DF BE 32 3A E1 31 5A 7A DA 89 7B 4F 9F 13 56 72 C6 B0 33 00 8E 62 7C 6E C3 B3 28 16 DE 2A 07 57 E2 9D 04 4F 9F 1B 41 66 DC B2 23 1D C4 60 05 46 8D E9 0D 10 FD 38 6C 40 F2 BF 2C 2B C9 3D 4F 2E FC BA 1E 58 E3 34 76 57 E2 9D 24 5C F8 6E 76 57 85 AE 08 14 F7 31 0A 44 FF 94 29 42 FA 0C 40 6C 81 AE 15 12 C4 3C 53 7C D7 92 02 40 E4 2D 52 2E DF 89 6D 37 E8 3A 12 5F CA 8F 32 23 D5 10 7E 61 C1 9B 73 46 C4 6F 4E 2B 8E E0 69 23 8E 62 68 28 9C F7 74 42 E0 39 41 74 DA 9F 17 22 FA 19 0C 63 F8 8A 2D 19 D2 2D 43 66 D0 97 09 1F FC 6E 78 7B 83 BF 22 4A D5 16 5A 43 86 EE 31 3E C9 3A 50 63 81 BA 0F 39 D6 6C 61 55 DE E4 24 25 C2 66 7F 66 D0 9F 0C 3F D6 14 41 65 80 AF 74 43 C2 24 0C 57 F0 EC 77 36 E9 29 04 2B 8F F3 17 4D 8C 1A 69 28 F2 EB 28 1F FC 34 6F 63 C0 EE 75 35 DF 3C 70 73 EB B0 13 0B 84 34 71 43 D8 8C 0D 44 F9 2B 7B 53 DF 95 15 32 C4 24 7C 6E 98 98 00 4A E0 1A 5C 6C EB 8B 24 5C 89 17 5F 71 C0 AA 13 58 9B 3B 43 79 E2 A8 01 01 FD 0A 43 6F D1 92 74 5C F2 0B 76 63 F2 9F 2D 47 C9 0F 04 2B 8F F3 02 23 8E 62 7D 47 8D E4 2D 24 88 26 6D 71 8A B6 23 07 E6 28 72 75 C7 BF 25 10 F9 09 12 58 C5 93 13 1C C8 16 6C 5E F5 BA 23 36 CA 0A 5A 20 C0 E8 76 11 FE 67 7E 4C F7 84 7F 46 E9 0A 08 7B C7 B1 0E 1D C0 6D 0F 2F D4 B9 08 46 9B 0C 09 54 C7 BE 73 41 D2 6B 50 7D C5 A4 72 3E DC 2D 68 2B 8E E0 69 37 E1 60 05 5F DD AA 23 01 C3 3B 68 28 D4 92 22 24 F7 06 51 41 81 8B 22 03 FC 33 75 53 C2 96 23 26 DA 13 6F 67 81 B0 6D 1E FA 26 6B 61 DF AF 2F 20 CA 3F 4E 2F C2 EC 75 2A F4 2C 6C 78 C3 B7 0D 1F 81 3B 6B 59 C2 9A 3F 15 83 37 4D 2F E4 AA 09 38 DE 28 48 55 83 88 15 03 D4 36 5A 54 C0 9D 21 21 FC 29 04 2B 8F F3 0F 1D C6 3B 4B 65 D6 8D 78 4F F4 60 0D 75 F7 9B 0A 06 D5 6E 61 72 DB EF 0C 03 C2 15 7A 53 E0 8F 09 05 F6 3F 7E 66 84 EC 3C 35 FF 14 5B 7E E6 B4 7E 22 F4 36 48 4E D1 9D 29 1B C5 2F 08 6E 8A BA 77 1A E4 27 7F 67 E4 BA 01 3B C0 6E 58 77 E0 98 33 58 C0 0C 61 5F DF AA 2D 1D EA 1B 58 46 D1 AF 02 1C E9 15 63 7D FD 97 73 22 D3 28 0A 6C DB BD 09 02 D8 69 55 27 E5 8C 20 35 82 19 0A 62 DE E9 21 1B D3 04 6F 22 CB E4 70 31 DE 13 7F 77 D8 9D 0A 4A DB 17 60 63 FE ED 1E 35 C8 3F 6B 78 E6 BB 15 07 DB 3B 09 6C E1 EA 3F 18 D1 2A 16 53 FA 89 75 37 E6 31 7D 25 F6 E1 7A 5C F4 60 05 39 E1 8F 07 38 D5 27 6F 77 DF A9 23 4D
"""

KEY_HEX = "dc4673b05e3916b3"
KEY     = bytes.fromhex(KEY_HEX)          # 8-byte repeating key

# ----------------------------------------------------------------------
def xor_decrypt(cipher: bytes, key: bytes) -> bytes:
    klen = len(key)
    return bytes(b ^ key[i % klen] for i, b in enumerate(cipher))

def main():
    cipher_bytes = bytes.fromhex(''.join(HEX_BLOB.split()))
    plain_bytes  = xor_decrypt(cipher_bytes, KEY)

    # Show as UTF-8 (XML) and also save
    try:
        print(plain_bytes.decode('utf-8'))
    except UnicodeDecodeError:
        print("[!] Decrypted data isnâ€™t pure UTF-8; dumping hex instead.")
        print(plain_bytes.hex())

    with open("priv.xml", "wb") as f:
        f.write(plain_bytes)
    print("[+] Saved to priv.xml")

if __name__ == "__main__":
    main()
