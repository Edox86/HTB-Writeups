#!/usr/bin/env python3
# xor_unmask_privkey.py

HEX_BLOB = """
E0 14 20 F1 15 5C 6F E5 BD 2A 06 D5 60 05 5B DC B8 33 1F C5 2D 07 65 DF 8C 2F 11 D9 11 78 7E EB EF 1F 35 FC 67 09 4E DF 9A 0A 11 D8 39 57 7B C9 AC 02 18 D7 0E 57 5C C1 8A 0D 41 83 19 0D 63 D6 B8 77 2A DD 27 0C 78 C6 EC 07 10 F6 24 0A 6C FA B5 2E 1F C0 37 01 21 DE 86 09 40 FE 75 6F 25 FF 86 7E 0B C0 32 6E 61 EA 86 10 1B 9B 3A 5B 55 C6 9D 15 00 C1 3B 69 54 C3 96 30 5C D2 38 4B 3D E4 97 07 02 F7 6B 41 5B FC A5 08 35 80 1D 0F 24 E0 B8 11 26 C2 6B 5F 72 DC 90 2F 0B FD 2B 53 61 C5 99 1C 43 DF 15 5F 5F D5 85 28 41 D5 24 12 44 D1 93 2D 1D 83 2F 7E 26 D9 A5 03 5C D2 6A 74 43 E3 89 7B 4F 9F 13 56 72 C6 B0 33 00 8E 62 7C 6E C3 B3 28 16 DE 2A 07 57 E2 9D 04 4F 9F 1B 41 66 DC B2 23 1D C4 60 05 46 8D EC 23 06 82 67 5C 52 8B 95 16 40 FC 0A 7C 6E 81 8B 7E 24 F8 16 4F 72 C6 88 3C 27 E2 69 0E 63 D6 88 30 22 FA 69 01 74 DA 9A 09 47 FA 30 4C 39 E7 EB 0F 18 9F 28 53 60 C4 84 15 25 F7 6F 56 52 EA 96 01 4B D5 2C 7B 7B E9 88 0B 07 D8 18 53 5C DD BB 7F 0B DA 6F 4E 2B 8E E0 69 23 8E 62 68 28 81 84 2C 26 F1 6F 4F 5E C5 B4 22 46 E1 6A 6B 65 E1 E8 3E 3C 9F 07 78 59 C2 9E 25 25 FB 6C 0C 61 9C 9F 02 11 86 10 7E 42 E6 89 7F 30 85 6A 12 27 F6 B4 16 29 D4 36 6C 57 F4 9B 0F 22 E2 15 6D 5F 81 ED 2E 39 EA 6A 5F 21 F0 B8 71 40 FE 33 70 70 82 90 2A 2A F5 29 04 2B 8F F3 17 4D 8C 1A 69 28 EB 8D 3F 46 F3 29 7B 6E D4 B7 1F 4A D1 08 72 6C EB 98 27 22 DB 16 00 66 FB 9E 71 09 C4 75 49 4F EB F3 0A 47 C6 14 49 44 98 97 2D 27 F2 2F 48 43 F8 E5 0B 1A C5 1A 63 7A D0 EC 14 18 C8 1F 41 43 C4 AF 01 1E C6 11 0F 42 84 EE 04 05 EA 2F 7F 62 F5 8E 31 39 9F 0F 04 2B 8F F3 02 23 8E 62 7D 47 8D B8 0C 12 85 33 43 2F E4 93 72 04 D3 16 00 27 D1 AD 73 22 F7 11 6B 59 CB 8E 7F 46 C7 14 78 59 DE B3 14 26 F1 2D 75 4E F0 A8 07 34 85 0A 58 7B E4 B1 37 25 83 30 6D 24 C6 F7 2B 3C F1 3D 43 6F D4 A6 2F 4A C2 6E 4E 6E C0 AB 37 3F 89 36 16 58 D7 93 76 4A FF 3C 4E 2B 8E E0 69 37 E1 60 05 5F DD AA 23 01 C3 3B 68 28 C4 EE 15 21 EA 2C 4A 67 87 B1 0C 46 9B 6C 71 5C F8 89 01 19 D1 15 0A 4F FD B9 28 46 81 0C 56 50 D5 AE 16 41 C0 75 74 44 D0 F7 12 58 E2 6E 73 7C D5 A4 76 18 E6 10 53 22 CA 94 09 4B D4 1A 0C 6E F1 88 75 1F F2 75 7E 22 D2 A8 34 1D D2 07 16 42 FD AB 2A 0A DA 0F 04 2B 8F F3 0F 1D C6 3B 4B 65 D6 8D 78 4F F4 60 7B 57 CA 98 2E 46 C9 33 4F 7B F6 A8 00 00 C5 1D 7A 59 FA AA 36 36 F2 17 73 73 87 BF 33 02 E0 66 7A 23 E7 A5 0A 1A DC 09 0B 51 F4 E8 6D 39 FD 38 60 2E CB B8 3E 1A 89 09 74 46 85 AC 0A 39 F9 2C 77 39 86 EA 37 58 DB 30 4B 73 C0 EE 3F 14 C5 0C 69 5A FC BB 0E 2B C7 38 7D 5D DB B4 03 0B C2 3F 72 58 81 9B 1E 43 D3 17 5C 59 E0 93 0B 3F 85 24 40 7D DF 9B 3E 1F D4 67 5F 44 DA E4 2A 07 DE 6B 5B 5C C2 B9 1C 1A 80 26 50 4F D8 8C 3E 03 F9 32 50 55 E4 8D 77 42 DF 12 5D 58 CA E5 08 23 FF 12 5F 70 DF 99 34 34 C5 1C 6F 75 F6 E1 7A 5C F4 60 05 39 E1 8F 07 38 D5 27 6F 77 DF A9 23 4D
"""

KEY_HEX = "dc4673b05e3916b3"
KEY     = bytes.fromhex(KEY_HEX)          # 8-byte repeating key

# ----------------------------------------------------------------------
def xor_decrypt(cipher: bytes, key: bytes) -> bytes:
    klen = len(key)
    return bytes(b ^ key[i % klen] for i, b in enumerate(cipher))

def main():
    cipher_bytes = bytes.fromhex(''.join(HEX_BLOB.split()))
    plain_bytes  = xor_decrypt(cipher_bytes, KEY)

    # Show as UTF-8 (XML) and also save
    try:
        print(plain_bytes.decode('utf-8'))
    except UnicodeDecodeError:
        print("[!] Decrypted data isnâ€™t pure UTF-8; dumping hex instead.")
        print(plain_bytes.hex())

    with open("priv.xml", "wb") as f:
        f.write(plain_bytes)
    print("[+] Saved to priv.xml")

if __name__ == "__main__":
    main()
